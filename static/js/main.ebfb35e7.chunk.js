(this.webpackJsonpspotit=this.webpackJsonpspotit||[]).push([[0],{108:function(e,t,n){},12:function(e,t,n){e.exports={AlbumCard:"AlbumCard_AlbumCard___MstQ",albumProps:"AlbumCard_albumProps__3d39H",imgContainer:"AlbumCard_imgContainer__1duqt",main:"AlbumCard_main__34eND",name:"AlbumCard_name__2lo9n",artists:"AlbumCard_artists__3D034",preview:"AlbumCard_preview__3O7T0"}},18:function(e,t,n){e.exports={ArtistCard:"ArtistCard_ArtistCard__ZCdVO",imgContainer:"ArtistCard_imgContainer__Kd-f2",main:"ArtistCard_main__1RTcx",name:"ArtistCard_name__3X3IS",rating:"ArtistCard_rating__2E4FB"}},244:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(37),s=n.n(a),o=n(23),i=n(99),l=n(3),u="SET_ACCESS_TOKEN",j="REMOVE_ACCESS_TOKEN",b="SET_ARTISTS",d="REMOVE_ARTISTS",f="SET_LAST_SEARCH",m="SET_CURRENT_ARTIST",h="REMOVE_CURRENT_ARTIST",g="SET_ALBUMS",O="REMOVE_ALBUMS",p="SET_NEXT_ARTISTS_URL",x="SET_NEXT_ALBUMS_URL",_=n(63),v=function(e,t){return Object(_.a)(Object(_.a)({},e),t)},S={accessToken:!!localStorage.getItem("accessToken"),artists:null,lastSearch:"",currentArtist:null,albums:null,nextArtistsUrl:null,nextAlbumsUrl:null},A=function(e,t){return localStorage.setItem("accessToken",t.accessToken),localStorage.setItem("expiresAt",t.expiresAt),v(e,{accessToken:!0})},T=function(e,t){return localStorage.removeItem("accessToken"),localStorage.removeItem("expiresAt"),v(e,{accessToken:!1,timer:null})},C=function(e,t){return v(e,{artists:t.artists})},N=function(e,t){return v(e,{artists:null})},k=function(e,t){return v(e,{lastSearch:t.lastSearch})},y=function(e,t){return v(e,{currentArtist:t.currentArtist})},E=function(e,t){return v(e,{currentArtist:null})},w=function(e,t){return v(e,{albums:t.albums})},L=function(e,t){return v(e,{albums:null})},R=function(e,t){return v(e,{nextArtistsUrl:t.nextArtistsUrl})},I=function(e,t){return v(e,{nextAlbumsUrl:t.nextAlbumsUrl})},U=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case u:return A(e,t);case j:return T(e);case b:return C(e,t);case d:return N(e);case f:return k(e,t);case m:return y(e,t);case h:return E(e);case g:return w(e,t);case O:return L(e);case p:return R(e,t);case x:return I(e,t);default:return e}},P=(n(108),n(9)),B=n(4),M=function(){return{type:j}},H=function(e){return{type:m,currentArtist:e}},F=n.p+"static/media/spotifyLogo.bc1a3e4c.svg",z=n(96),D=n.n(z),V=n(1),X=function(e){return Object(V.jsxs)("a",{href:e.href,className:D.a.SpotifyLogin,children:[Object(V.jsx)("span",{children:"Login with Spotify"}),Object(V.jsx)("img",{src:F,alt:"Spotify logo"})]})},q=n(57),K=n.n(q),Q=function(e){var t=Object(l.c)((function(e){return e.accessToken})),n=Object(l.b)(),r=Object(c.useCallback)((function(e,t){return n(function(e,t){return{type:u,accessToken:e,expiresAt:t}}(e,t))}),[n]),a=Object(c.useCallback)((function(){return n(M())}),[n]);return Object(c.useEffect)((function(){if(t)e.history.replace("/artists");else{var n=new URLSearchParams(e.location.hash.replace("#","?")),c=n.get("access_token");if(c){var a=(new Date).getTime(),s=1e3*parseInt(n.get("expires_in"));r(c,a+s),e.history.replace("/artists")}}}),[e,t,r,a]),Object(V.jsxs)("section",{className:K.a.LoginPage,children:[Object(V.jsxs)("h1",{className:K.a.welcome,children:[Object(V.jsx)("span",{children:"Welcome to Spotit,"})," Get started here"]}),Object(V.jsx)(X,{href:"https://accounts.spotify.com/authorize?client_id=6499b09693a64a09ae4d961182500473&redirect_uri=http://localhost:3000/login&response_type=token&state=123"})]})},W=n(21),Y=n(245),J=n.p+"static/media/search.f8c9c140.svg",Z=n(97),G=n.n(Z),$=function(e){var t=Object(c.useRef)(),n=Object(l.c)((function(e){return e.lastSearch})),r=Object(c.useState)(e.lastSearch),a=Object(P.a)(r,2),s=a[0],o=a[1],i=function(n){if(n.preventDefault(),t.current){var c=t.current.value.trim();c&&e.search(c)}};return Object(V.jsxs)("form",{onSubmit:i,className:G.a.SearchBar,children:[Object(V.jsx)("input",{ref:t,id:"searchInput",type:"text",value:s,placeholder:"Search for an artist...",onChange:function(c){o(c.target.value);var r=c.target.value.trim();setTimeout((function(){if(t.current){var c=t.current.value.trim();console.log(r),console.log(c),c!==n&&r===c&&e.search(r)}}),500)}}),Object(V.jsx)("img",{src:J,alt:"",onClick:i})]})},ee=n(98),te=n.n(ee),ne={transitionDuration:0},ce=function(e){return Object(V.jsx)(te.a,{options:ne,children:e.children})},re=n(26),ae=n.n(re),se=function(e){return ae.a.get(e,{headers:{Authorization:"Bearer "+localStorage.getItem("accessToken")}})},oe=n(18),ie=n.n(oe),le=function(e){for(var t=Math.floor(e.rating),n=[],c=1;c<=5;c++)if(c<t)n.push(Object(V.jsx)("div",{style:{background:"var(--color-bright-green)"}},c));else if(c<e.rating){var r=100*(e.rating-t);n.push(Object(V.jsx)("div",{style:{background:"linear-gradient(90deg, var(--color-bright-green) ".concat(r,"%, var(--color-gray) ").concat(100-r,"%)")}},c))}else n.push(Object(V.jsx)("div",{style:{background:"var(--color-gray)"}},c));return Object(V.jsxs)("div",{className:ie.a.ArtistCard,onClick:e.redirect,children:[Object(V.jsx)("div",{className:ie.a.imgContainer,children:Object(V.jsx)("img",{src:e.image,alt:e.name})}),Object(V.jsxs)("div",{className:ie.a.main,children:[Object(V.jsx)("h5",{className:ie.a.name,children:e.name}),Object(V.jsxs)("p",{className:ie.a.followers,children:[e.followers," followers"]}),Object(V.jsx)("div",{className:ie.a.rating,children:n})]})]})},ue=n(58),je=n.n(ue),be=function(e){return Object(V.jsx)(V.Fragment,{children:Object(V.jsx)("img",{src:F,alt:"",className:[je.a.Spinner,je.a[e.className]].join(" ")})})},de=n.p+"static/media/defaultArtist.b95d14e9.png",fe=n(27),me=n.n(fe),he=function(e){var t=Object(c.useRef)(),n=Object(c.useState)(!1),r=Object(P.a)(n,2),a=r[0],s=r[1],o=Object(c.useState)(null),i=Object(P.a)(o,2),u=(i[0],i[1],Object(c.useState)(!1)),j=Object(P.a)(u,2),m=j[0],g=j[1],x=Object(l.c)((function(e){return e.artists})),_=Object(l.c)((function(e){return e.lastSearch})),v=Object(l.c)((function(e){return e.currentArtist})),S=Object(l.c)((function(e){return e.albums})),A=Object(l.c)((function(e){return e.nextArtistsUrl})),T=Object(l.b)(),C=Object(c.useCallback)((function(e){return T(function(e){return{type:b,artists:e}}(e))}),[T]),N=function(){return T({type:d})},k=function(e){return T(function(e){return{type:f,lastSearch:e}}(e))},y=Object(c.useCallback)((function(){return T({type:h,currentArtist:null})}),[T]),E=Object(c.useCallback)((function(){return T({type:O,albums:null})}),[T]),w=Object(c.useCallback)((function(e){return T(function(e){return{type:p,nextArtistsUrl:e}}(e))}),[T]);Object(c.useEffect)((function(){S&&E(),v&&y();var e=function(){t.current&&(t.current.getBoundingClientRect().top<=window.innerHeight+100&&(m||(g(!0),A&&se(A).then((function(e){console.log(e),w(e.data.artists.next),C([].concat(Object(W.a)(x),Object(W.a)(e.data.artists.items))),g(!1)})).catch((function(e){return console.log(e)})))))};return console.log("create"),window.addEventListener("scroll",e),function(){console.log("remove"),window.removeEventListener("scroll",e)}}),[m,x,v,S,A,w,C,y,E]);var L=function(t){!function(e){T(H(e))}({id:t.id,name:t.name}),e.history.push("/albums/".concat(t.id))},R=null===x||void 0===x?void 0:x.map((function(e){var t;return Object(V.jsx)(le,{redirect:function(){return L(e)},image:(null===(t=e.images[1])||void 0===t?void 0:t.url)||de,name:e.name,followers:e.followers.total,rating:e.popularity/20},Object(Y.a)())})),I=Object(V.jsx)(ce,{children:R}),U=a?Object(V.jsx)(be,{className:"fixed"}):I,B=m?A?Object(V.jsx)(be,{}):Object(V.jsx)("h3",{children:"You've Reached the End"}):null;return Object(V.jsxs)("section",{className:me.a.ArtistsPage,children:[Object(V.jsx)("div",{className:me.a.searchBox,children:Object(V.jsx)($,{search:function(e){if(!e)return N(),void k(e);s(!0),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=e?"q=".concat(e):"",a=t.length?"type=".concat(t.join(",")):"",s=n?"limit=".concat(n):"",o=c?"offset=".concat(c):"";return ae.a.get("https://api.spotify.com/v1/search?".concat(r,"&").concat(a,"&").concat(s,"&").concat(o),{headers:{Authorization:"Bearer "+localStorage.getItem("accessToken")}})}(e,["artist"],20).then((function(t){console.log(t),C(t.data.artists.items),k(e),s(!1),w(t.data.artists.next)})).catch((function(e){return console.log(e)}))},lastSearch:_})}),Object(V.jsx)("p",{className:me.a.searchText,children:R?R.length?"Showing results for '".concat(_,"'"):"No Results Found for '".concat(_,"'"):"Type anything in the search box to get started!"}),U,Object(V.jsx)("footer",{className:me.a.footer,ref:t,children:B})]})},ge=n(12),Oe=n.n(ge),pe=function(e){return Object(V.jsxs)("div",{className:Oe.a.AlbumCard,children:[Object(V.jsxs)("div",{className:Oe.a.albumProps,children:[Object(V.jsx)("div",{className:Oe.a.imgContainer,children:Object(V.jsx)("img",{src:e.image,alt:e.name})}),Object(V.jsxs)("div",{className:Oe.a.main,children:[Object(V.jsx)("h5",{className:Oe.a.name,children:e.name}),Object(V.jsx)("p",{className:Oe.a.artists,children:e.artists.join(" ")}),Object(V.jsx)("p",{className:Oe.a.date,children:e.date}),Object(V.jsxs)("p",{className:Oe.a.tracks,children:[e.tracks," tracks"]})]})]}),Object(V.jsx)("a",{className:Oe.a.preview,href:e.preview,children:Object(V.jsx)("span",{children:"Preview on Spotify"})})]})},xe=n.p+"static/media/defaultAlbum.7d7102cb.png",_e=n(40),ve=n.n(_e),Se=function(e){var t=Object(c.useRef)(),n=Object(c.useState)(!1),r=Object(P.a)(n,2),a=r[0],s=(r[1],Object(c.useState)(null)),o=Object(P.a)(s,2),i=(o[0],o[1],Object(c.useState)(!1)),u=Object(P.a)(i,2),j=u[0],b=u[1],d=Object(l.c)((function(e){return e.currentArtist})),f=Object(l.c)((function(e){return e.albums})),m=Object(l.c)((function(e){return e.nextAlbumsUrl})),h=Object(l.b)(),O=Object(c.useCallback)((function(e){return h(H(e))}),[h]),p=Object(c.useCallback)((function(e){return h(function(e){return{type:g,albums:e}}(e))}),[h]),_=Object(c.useCallback)((function(e){return h(function(e){return{type:x,nextAlbumsUrl:e}}(e))}),[h]);Object(c.useEffect)((function(){var n;d||(n=e.match.params.id,ae.a.get("https://api.spotify.com/v1/artists/".concat(n),{headers:{Authorization:"Bearer "+localStorage.getItem("accessToken")}})).then((function(e){console.log(e),O({id:e.data.id,name:e.data.name})})).catch((function(e){return console.log(e)})),f||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=t.length?"include_groups=".concat(t.join(",")):"",a=n?"limit=".concat(n):"",s=c?"offset=".concat(c):"";return ae.a.get("https://api.spotify.com/v1/artists/".concat(e,"/albums?").concat(r,"&").concat(a,"&").concat(s),{headers:{Authorization:"Bearer "+localStorage.getItem("accessToken")}})}(e.match.params.id,[],20).then((function(e){console.log(e),e.data.items.forEach((function(e){return e.artists=e.artists.map((function(e){return e.name}))})),p(e.data.items),_(e.data.next)})).catch((function(e){return console.log(e)}));var c=function(){t.current&&(t.current.getBoundingClientRect().top<=window.innerHeight+100&&(j||(b(!0),m&&se(m).then((function(e){console.log(e),e.data.items.forEach((function(e){return e.artists=e.artists.map((function(e){return e.name}))})),p([].concat(Object(W.a)(f),Object(W.a)(e.data.items))),_(e.data.next),b(!1)})).catch((function(e){return console.log(e)})))))};return console.log("create"),window.addEventListener("scroll",c),function(){console.log("remove"),window.removeEventListener("scroll",c)}}),[e,j,d,f,m,_,O,p]);var v,S=null===f||void 0===f?void 0:f.map((function(e){var t;return Object(V.jsx)(pe,{image:(null===(t=e.images[1])||void 0===t?void 0:t.url)||xe,name:e.name,artists:e.artists,tracks:e.total_tracks,date:e.release_date,preview:e.external_urls.spotify},Object(Y.a)())}));S&&(v=S.length?Object(V.jsx)(ce,{children:S}):Object(V.jsx)("h1",{children:"No Albums yet"}));var A=a?Object(V.jsx)(be,{}):v,T=j?m?Object(V.jsx)(be,{}):Object(V.jsx)("h3",{children:"You've Reached the End"}):null;return Object(V.jsxs)("section",{className:ve.a.AlbumsPage,children:[Object(V.jsxs)("div",{className:ve.a.intro,children:[Object(V.jsx)("h1",{children:null===d||void 0===d?void 0:d.name}),Object(V.jsx)("span",{children:"Albums"})]}),A,Object(V.jsx)("footer",{className:ve.a.footer,ref:t,children:T})]})},Ae=n(59),Te=n.n(Ae),Ce=function(e){var t=Object(l.b)();return Object(V.jsx)("button",{className:[Te.a.Logout,Te.a[e.className]].join(" "),onClick:function(){localStorage.removeItem("accessToken"),localStorage.removeItem("expiresAt"),t(M())},children:"Logout"})},Ne=n(60),ke=n.n(Ne),ye=function(e){return console.log(e.accessToken),Object(V.jsxs)("nav",{className:ke.a.Header,children:[Object(V.jsxs)(o.b,{to:"/artists",className:ke.a.Logo,children:[Object(V.jsx)("img",{src:F,alt:""}),Object(V.jsx)("h1",{children:"Spotit"})]}),e.accessToken?Object(V.jsx)(Ce,{className:"header"}):null]})},Ee=Object(B.h)((function(){var e=Object(c.useState)(null),t=Object(P.a)(e,2),n=t[0],r=t[1],a=Object(l.c)((function(e){return e.accessToken})),s=Object(l.b)(),o=Object(c.useCallback)((function(){return s(M())}),[s]),i=Object(B.g)().pathname;return Object(c.useEffect)((function(){if(a){var e=localStorage.getItem("expiresAt"),t=(new Date).getTime();setTimeout((function(){o()}),e-t)}else"/login"!==i&&r(Object(V.jsx)(B.a,{to:"/login"}))}),[a,i,o]),Object(V.jsxs)(V.Fragment,{children:[Object(V.jsx)(ye,{accessToken:a}),Object(V.jsxs)(B.d,{children:[Object(V.jsx)(B.b,{exact:!0,path:"/login",component:Q}),Object(V.jsx)(B.b,{exact:!0,path:"/artists",component:he}),Object(V.jsx)(B.b,{exact:!0,path:"/albums/:id",component:Se})]}),n]})})),we=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,246)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))},Le=Object(i.a)(U);s.a.render(Object(V.jsx)(r.a.StrictMode,{children:Object(V.jsx)(l.a,{store:Le,children:Object(V.jsx)(o.a,{basename:"/",children:Object(V.jsx)(Ee,{})})})}),document.getElementById("root")),we()},27:function(e,t,n){e.exports={footer:"ArtistsPage_footer__1yNVf",searchBox:"ArtistsPage_searchBox__32FPd",searchText:"ArtistsPage_searchText__1WZaa"}},40:function(e,t,n){e.exports={footer:"AlbumsPage_footer__251fr",intro:"AlbumsPage_intro__36c6W"}},57:function(e,t,n){e.exports={LoginPage:"LoginPage_LoginPage__2jbru",welcome:"LoginPage_welcome__1pizM"}},58:function(e,t,n){e.exports={Spinner:"Spinner_Spinner__1Hsyz",loading:"Spinner_loading__kqbuU",fixed:"Spinner_fixed__2U3x0"}},59:function(e,t,n){e.exports={Logout:"Logout_Logout__M7RYp",header:"Logout_header__1zRfy"}},60:function(e,t,n){e.exports={Header:"Header_Header__MTfQT",Logo:"Header_Logo__1S6Qb"}},96:function(e,t,n){e.exports={SpotifyLogin:"SpotifyLogin_SpotifyLogin__NuURX"}},97:function(e,t,n){e.exports={SearchBar:"SearchBar_SearchBar__8Soa7"}}},[[244,1,2]]]);
//# sourceMappingURL=main.ebfb35e7.chunk.js.map