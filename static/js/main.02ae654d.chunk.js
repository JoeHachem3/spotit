(this.webpackJsonpspotit=this.webpackJsonpspotit||[]).push([[0],{100:function(t,e,n){t.exports={ErrorHandler:"ErrorHandler_ErrorHandler__nFqWt"}},110:function(t,e,n){},12:function(t,e,n){t.exports={AlbumCard:"AlbumCard_AlbumCard___MstQ",albumGrid:"AlbumCard_albumGrid__1Mgxn",imgContainer:"AlbumCard_imgContainer__1duqt",preview:"AlbumCard_preview__3O7T0",main:"AlbumCard_main__34eND",name:"AlbumCard_name__2lo9n",artists:"AlbumCard_artists__3D034"}},18:function(t,e,n){t.exports={ArtistCard:"ArtistCard_ArtistCard__ZCdVO",imgContainer:"ArtistCard_imgContainer__Kd-f2",main:"ArtistCard_main__1RTcx",name:"ArtistCard_name__3X3IS",rating:"ArtistCard_rating__2E4FB"}},246:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(37),s=n.n(c),i=n(23),o=n(101),u=n(4),l="SET_ACCESS_TOKEN",j="REMOVE_ACCESS_TOKEN",b="SET_TIMEOUT_ID",d="SET_ARTISTS",m="REMOVE_ARTISTS",f="SET_LAST_SEARCH",h="SET_CURRENT_ARTIST",O="REMOVE_CURRENT_ARTIST",g="SET_ALBUMS",x="REMOVE_ALBUMS",_="SET_NEXT_ARTISTS_URL",p="SET_NEXT_ALBUMS_URL",v=n(64),S=function(t,e){return Object(v.a)(Object(v.a)({},t),e)},A=function(t){var e=""+t,n=(e.length-1)/3;if(n>=1){var r=Math.floor(n),a="KMGT"[r-1],c=3*(n-r);return e.slice(0,c+1)+"."+e.slice(c+2,c+3)+a}return t},T={accessToken:!!localStorage.getItem("accessToken"),timeOutId:null,artists:null,lastSearch:"",currentArtist:null,albums:null,nextArtistsUrl:null,nextAlbumsUrl:null},C=function(t,e){return localStorage.setItem("accessToken",btoa(e.accessToken)),localStorage.setItem("expiresAt",e.expiresAt),S(t,{accessToken:!0})},k=function(t,e){return localStorage.removeItem("accessToken"),localStorage.removeItem("expiresAt"),t.timeOutId&&clearTimeout(t.timeOutId),S(t,{accessToken:!1,timeOutId:null,artists:null,lastSearch:"",currentArtist:null,albums:null,nextArtistsUrl:null,nextAlbumsUrl:null})},N=function(t,e){return S(t,{timeOutId:e.timeOutId})},y=function(t,e){return S(t,{artists:e.artists})},E=function(t,e){return S(t,{artists:null})},w=function(t,e){return S(t,{lastSearch:e.lastSearch})},L=function(t,e){return S(t,{currentArtist:e.currentArtist})},I=function(t,e){return S(t,{currentArtist:null})},R=function(t,e){return S(t,{albums:e.albums})},B=function(t,e){return S(t,{albums:null})},U=function(t,e){return S(t,{nextArtistsUrl:e.nextArtistsUrl})},P=function(t,e){return S(t,{nextAlbumsUrl:e.nextAlbumsUrl})},M=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case l:return C(t,e);case j:return k(t);case b:return N(t,e);case d:return y(t,e);case m:return E(t);case f:return w(t,e);case h:return L(t,e);case O:return I(t);case g:return R(t,e);case x:return B(t);case _:return U(t,e);case p:return P(t,e);default:return t}},H=(n(110),n(3)),F=n(26),z=n.n(F),D="https://accounts.spotify.com/authorize?client_id=6499b09693a64a09ae4d961182500473&redirect_uri=".concat("https://joehachem3.github.io/spotit","/%23/&response_type=token&state=123"),V=function(t){return z.a.get(t,{headers:{Authorization:"Bearer "+atob(localStorage.getItem("accessToken"))}})},W=n.p+"static/media/spotifyLogo.bc1a3e4c.svg",G=n(97),q=n.n(G),K=n(1),X=function(t){return Object(K.jsxs)("a",{href:t.href,className:q.a.SpotifyLogin,children:[Object(K.jsx)("span",{children:"Login with Spotify"}),Object(K.jsx)("img",{src:W,alt:"Spotify logo"})]})},Y=n(57),Q=n.n(Y),J=function(){return Object(K.jsxs)("section",{className:Q.a.LoginPage,children:[Object(K.jsxs)("h1",{className:Q.a.welcome,children:[Object(K.jsx)("span",{children:"Welcome to Spotit,"})," Get started here"]}),Object(K.jsx)(X,{href:D})]})},Z=n(21),$=n(11),tt=n(247),et=n.p+"static/media/search.f8c9c140.svg",nt=n(98),rt=n.n(nt),at=function(t){var e=Object(r.useRef)(),n=Object(u.c)((function(t){return t.lastSearch})),a=Object(r.useState)(t.lastSearch),c=Object($.a)(a,2),s=c[0],i=c[1],o=function(n){if(n.preventDefault(),e.current){var r=e.current.value.trim();r&&t.search(r)}};return Object(K.jsxs)("form",{onSubmit:o,className:rt.a.SearchBar,children:[Object(K.jsx)("input",{ref:e,id:"searchInput",type:"text",value:s,placeholder:"Search for an artist...",onChange:function(r){i(r.target.value);var a=r.target.value.trim();setTimeout((function(){if(e.current){var r=e.current.value.trim();r!==n&&a===r&&t.search(a)}}),500)}}),Object(K.jsx)("img",{src:et,alt:"",onClick:function(t){e.current.value?o(t):e.current.focus()}})]})},ct=n(99),st=n.n(ct),it={transitionDuration:0},ot=function(t){return Object(K.jsx)(st.a,{options:it,children:t.children})},ut=n(18),lt=n.n(ut),jt=function(t){for(var e=Math.floor(t.rating),n=[],r=1;r<=5;r++)if(r<e)n.push(Object(K.jsx)("div",{style:{background:"var(--color-bright-green)"}},r));else if(r<t.rating){var a=100*(t.rating-e);n.push(Object(K.jsx)("div",{style:{background:"linear-gradient(90deg, var(--color-bright-green) ".concat(a,"%, var(--color-gray) ").concat(100-a,"%)")}},r))}else n.push(Object(K.jsx)("div",{style:{background:"var(--color-gray)"}},r));return Object(K.jsxs)("div",{className:lt.a.ArtistCard,onClick:t.redirect,children:[Object(K.jsx)("div",{className:lt.a.imgContainer,children:Object(K.jsx)("img",{src:t.image,alt:t.name})}),Object(K.jsxs)("div",{className:lt.a.main,children:[Object(K.jsx)("h5",{className:lt.a.name,children:t.name}),Object(K.jsxs)("p",{className:lt.a.followers,children:[t.followers," followers"]}),Object(K.jsx)("div",{className:lt.a.rating,children:n})]})]})},bt=n(58),dt=n.n(bt),mt=function(t){return Object(K.jsx)(K.Fragment,{children:Object(K.jsx)("img",{src:W,alt:"",className:[dt.a.Spinner,dt.a[t.className]].join(" ")})})},ft=n(100),ht=n.n(ft),Ot=function(t){var e=t.children;return t.error&&(e=Object(K.jsxs)("div",{className:ht.a.ErrorHandler,children:[Object(K.jsx)("h1",{children:t.error.message}),Object(K.jsx)("p",{children:"Oops... Something went wrong, try again later!"})]})),e},gt=function(){return{type:j}},xt=function(t){return{type:h,currentArtist:t}},_t=n.p+"static/media/defaultArtist.b95d14e9.png",pt=n(27),vt=n.n(pt),St=function(t){var e=Object(r.useRef)(),n=Object(r.useState)(!1),a=Object($.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)(null),o=Object($.a)(i,2),l=o[0],j=o[1],b=Object(r.useState)(!1),h=Object($.a)(b,2),g=h[0],p=h[1],v=Object(u.c)((function(t){return t.artists})),S=Object(u.c)((function(t){return t.lastSearch})),T=Object(u.c)((function(t){return t.currentArtist})),C=Object(u.c)((function(t){return t.albums})),k=Object(u.c)((function(t){return t.nextArtistsUrl})),N=Object(u.b)(),y=Object(r.useCallback)((function(t){return N(function(t){return{type:d,artists:t}}(t))}),[N]),E=function(){return N({type:m})},w=function(t){return N(function(t){return{type:f,lastSearch:t}}(t))},L=Object(r.useCallback)((function(){return N({type:O,currentArtist:null})}),[N]),I=Object(r.useCallback)((function(){return N({type:x,albums:null})}),[N]),R=Object(r.useCallback)((function(t){return N(function(t){return{type:_,nextArtistsUrl:t}}(t))}),[N]);Object(r.useEffect)((function(){if(!l){C&&I(),T&&L();var t=function(){e.current&&(e.current.getBoundingClientRect().top<=window.innerHeight+100&&(g||(p(!0),k&&V(k).then((function(t){R(t.data.artists.next),y([].concat(Object(Z.a)(v),Object(Z.a)(t.data.artists.items))),p(!1)})).catch((function(t){s(!1),j(t)})))))};return window.addEventListener("scroll",t),function(){window.removeEventListener("scroll",t)}}}),[g,v,T,C,k,l,R,y,L,I]);var B=function(e){!function(t){N(xt(t))}({id:e.id,name:e.name}),t.history.push("/artists/".concat(e.id,"/albums"))},U=null===v||void 0===v?void 0:v.map((function(t){var e;return Object(K.jsx)(jt,{redirect:function(){return B(t)},image:(null===(e=t.images[1])||void 0===e?void 0:e.url)||_t,name:t.name,followers:A(t.followers.total),rating:t.popularity/20},Object(tt.a)())})),P=Object(K.jsx)(ot,{children:U}),M=c?Object(K.jsx)(mt,{className:"fixed"}):P,H=g?k?Object(K.jsx)(mt,{}):Object(K.jsx)("h4",{children:"You've Reached the End"}):null;return Object(K.jsxs)("section",{className:vt.a.ArtistsPage,children:[Object(K.jsx)("div",{className:vt.a.searchBox,children:Object(K.jsx)(at,{search:function(t){if(l&&j(null),!t)return E(),void w(t);s(!0),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t?"q=".concat(t):"",c=e.length?"type=".concat(e.join(",")):"",s=n?"limit=".concat(n):"",i=r?"offset=".concat(r):"";return z.a.get("https://api.spotify.com/v1/search?".concat(a,"&").concat(c,"&").concat(s,"&").concat(i),{headers:{Authorization:"Bearer "+atob(localStorage.getItem("accessToken"))}})}(t,["artist"],20).then((function(e){y(e.data.artists.items),w(t),s(!1),R(e.data.artists.next)})).catch((function(t){s(!1),j(t)}))},lastSearch:S})}),Object(K.jsxs)(Ot,{error:l,children:[Object(K.jsx)("h4",{className:vt.a.searchText,children:U?U.length?"Showing results for '".concat(S,"'"):"No Results Found for '".concat(S,"'"):Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)("span",{children:"Welcome,"}),Object(K.jsx)(K.Fragment,{children:"You can now search for you favorite artists!"})]})}),M]}),Object(K.jsx)("footer",{className:vt.a.footer,ref:e,children:H})]})},At=n(12),Tt=n.n(At),Ct=function(t){return Object(K.jsxs)("div",{className:Tt.a.AlbumCard,children:[Object(K.jsxs)("div",{className:Tt.a.albumGrid,children:[Object(K.jsx)("div",{className:Tt.a.imgContainer,children:Object(K.jsx)("img",{src:t.image,alt:t.name})}),Object(K.jsx)("a",{className:Tt.a.preview,href:t.preview,target:"_blank",rel:"noreferrer",children:Object(K.jsx)("span",{children:"Preview on Spotify"})})]}),Object(K.jsxs)("div",{className:Tt.a.main,children:[Object(K.jsx)("h5",{className:Tt.a.name,children:t.name}),Object(K.jsx)("p",{className:Tt.a.artists,children:t.artists.join(" ")}),Object(K.jsx)("p",{className:Tt.a.date,children:t.date}),Object(K.jsxs)("p",{className:Tt.a.tracks,children:[t.tracks," tracks"]})]})]})},kt=n(59),Nt=n.n(kt),yt=function(t){return Object(K.jsx)("button",{className:[Nt.a.Back,Nt.a[t.className]].join(" "),onClick:t.onClick,children:"Back"})},Et=n.p+"static/media/defaultAlbum.7d7102cb.png",wt=n(40),Lt=n.n(wt),It=function(t){var e=Object(r.useRef)(),n=Object(r.useState)(!1),a=Object($.a)(n,2),c=a[0],s=a[1],i=Object(r.useState)(null),o=Object($.a)(i,2),l=o[0],j=o[1],b=Object(r.useState)(!1),d=Object($.a)(b,2),m=d[0],f=d[1],h=Object(u.c)((function(t){return t.currentArtist})),O=Object(u.c)((function(t){return t.albums})),x=Object(u.c)((function(t){return t.nextAlbumsUrl})),_=Object(u.b)(),v=Object(r.useCallback)((function(t){return _(xt(t))}),[_]),S=Object(r.useCallback)((function(t){return _(function(t){return{type:g,albums:t}}(t))}),[_]),A=Object(r.useCallback)((function(t){return _(function(t){return{type:p,nextAlbumsUrl:t}}(t))}),[_]);Object(r.useEffect)((function(){if(!l){var n;h||(s(!0),(n=t.match.params.id,z.a.get("https://api.spotify.com/v1/artists/".concat(n),{headers:{Authorization:"Bearer "+atob(localStorage.getItem("accessToken"))}})).then((function(t){v({id:t.data.id,name:t.data.name}),s(!1)})).catch((function(t){s(!1),j(t)}))),O||(s(!0),function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=e.length?"include_groups=".concat(e.join(",")):"",c=n?"limit=".concat(n):"",s=r?"offset=".concat(r):"";return z.a.get("https://api.spotify.com/v1/artists/".concat(t,"/albums?").concat(a,"&").concat(c,"&").concat(s),{headers:{Authorization:"Bearer "+atob(localStorage.getItem("accessToken"))}})}(t.match.params.id,[],20).then((function(t){t.data.items.forEach((function(t){return t.artists=t.artists.map((function(t){return t.name}))})),S(t.data.items),A(t.data.next),s(!1)})).catch((function(t){s(!1),j(t)})));var r=function(){e.current&&(e.current.getBoundingClientRect().top<=window.innerHeight+100&&(m||(f(!0),x&&V(x).then((function(t){t.data.items.forEach((function(t){return t.artists=t.artists.map((function(t){return t.name}))})),S([].concat(Object(Z.a)(O),Object(Z.a)(t.data.items))),A(t.data.next),f(!1)})).catch((function(t){s(!1),f(!1),j(t)})))))};return window.addEventListener("scroll",r),function(){window.removeEventListener("scroll",r)}}}),[t,m,h,O,x,l,A,v,S]);var T,C=null===O||void 0===O?void 0:O.map((function(t){var e;return Object(K.jsx)(Ct,{image:(null===(e=t.images[1])||void 0===e?void 0:e.url)||Et,name:t.name,artists:t.artists,tracks:t.total_tracks,date:t.release_date.split("-")[0],preview:t.external_urls.spotify},Object(tt.a)())}));C&&(T=C.length?Object(K.jsx)(ot,{children:C}):Object(K.jsx)("h1",{children:"No Albums yet"}));var k=c?Object(K.jsx)(mt,{className:"fixed"}):T,N=m?x?Object(K.jsx)(mt,{}):Object(K.jsx)("h4",{children:"You've Reached the End"}):null;return Object(K.jsxs)("section",{className:Lt.a.AlbumsPage,children:[Object(K.jsxs)(Ot,{error:l,children:[Object(K.jsxs)("div",{className:Lt.a.intro,children:[Object(K.jsx)("h1",{children:null===h||void 0===h?void 0:h.name}),Object(K.jsx)("span",{children:"Albums"}),Object(K.jsx)(yt,{onClick:t.history.goBack,className:"albumsPageIntro"})]}),k]}),Object(K.jsx)("footer",{className:Lt.a.footer,ref:e,children:N})]})},Rt=n(60),Bt=n.n(Rt),Ut=function(t){var e=Object(u.b)();return Object(K.jsx)("button",{className:[Bt.a.Logout,Bt.a[t.className]].join(" "),onClick:function(){return e(gt())},children:"Logout"})},Pt=n(61),Mt=n.n(Pt),Ht=function(t){return Object(K.jsxs)("nav",{className:Mt.a.Header,children:[Object(K.jsxs)(i.b,{to:"/",className:Mt.a.Logo,children:[Object(K.jsx)("img",{src:W,alt:""}),Object(K.jsx)("h1",{children:"Spotit"})]}),t.accessToken?Object(K.jsx)(Ut,{className:"header"}):null]})},Ft=Object(H.h)((function(){var t=Object(u.c)((function(t){return t.accessToken})),e=Object(u.b)(),n=Object(r.useCallback)((function(t,n){return e(function(t,e){return{type:l,accessToken:t,expiresAt:e}}(t,n))}),[e]),a=Object(r.useCallback)((function(){return e(gt())}),[e]),c=Object(r.useCallback)((function(t){return e(function(t){return{type:b,timeOutId:t}}(t))}),[e]),s=Object(H.g)().pathname;return Object(r.useEffect)((function(){if(t){var e=localStorage.getItem("expiresAt"),r=(new Date).getTime(),i=setTimeout((function(){a()}),e-r);c(i)}else{var o=new URLSearchParams(s.replace("/","?")),u=o.get("access_token");if(u){var l=(new Date).getTime(),j=1e3*parseInt(o.get("expires_in")),b=l+j,d=setTimeout((function(){a()}),j);c(d),n(u,b)}}}),[t,s,n,a,c]),Object(K.jsxs)(K.Fragment,{children:[Object(K.jsx)(Ht,{accessToken:t}),Object(K.jsxs)(H.d,{children:[Object(K.jsx)(H.b,{exact:!0,path:"/",component:t?St:J}),Object(K.jsx)(H.b,{exact:!0,path:"/artists/:id/albums",component:It}),Object(K.jsx)(H.b,{path:"/",render:function(){return Object(K.jsx)(H.a,{to:"/"})}})]}),t?null:Object(K.jsx)(H.a,{to:"/"})]})})),zt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,248)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,c=e.getLCP,s=e.getTTFB;n(t),r(t),a(t),c(t),s(t)}))},Dt=Object(o.a)(M);s.a.render(Object(K.jsx)(a.a.StrictMode,{children:Object(K.jsx)(u.a,{store:Dt,children:Object(K.jsx)(i.a,{basename:"/",children:Object(K.jsx)(Ft,{})})})}),document.getElementById("root")),zt()},27:function(t,e,n){t.exports={searchBox:"ArtistsPage_searchBox__32FPd",searchText:"ArtistsPage_searchText__1WZaa",footer:"ArtistsPage_footer__1yNVf"}},40:function(t,e,n){t.exports={intro:"AlbumsPage_intro__36c6W",footer:"AlbumsPage_footer__251fr"}},57:function(t,e,n){t.exports={LoginPage:"LoginPage_LoginPage__2jbru",welcome:"LoginPage_welcome__1pizM"}},58:function(t,e,n){t.exports={Spinner:"Spinner_Spinner__1Hsyz",loading:"Spinner_loading__kqbuU",fixed:"Spinner_fixed__2U3x0"}},59:function(t,e,n){t.exports={Back:"Back_Back__m__4y",albumsPageIntro:"Back_albumsPageIntro__1Ws_f"}},60:function(t,e,n){t.exports={Logout:"Logout_Logout__M7RYp",header:"Logout_header__1zRfy"}},61:function(t,e,n){t.exports={Header:"Header_Header__MTfQT",Logo:"Header_Logo__1S6Qb"}},97:function(t,e,n){t.exports={SpotifyLogin:"SpotifyLogin_SpotifyLogin__NuURX"}},98:function(t,e,n){t.exports={SearchBar:"SearchBar_SearchBar__8Soa7"}}},[[246,1,2]]]);
//# sourceMappingURL=main.02ae654d.chunk.js.map